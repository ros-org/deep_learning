# 该仓库存放视觉清洗机相关代码、模型等文件

当前视觉框架版本号：v3.0.1

分类(天气)模型版本号：v3.0.0

分类(清洁度)模型版本号：v3.0.0

检测模型1版本号：v1.0.2

检测模型2版本号：v1.0.1

分割模型版本号：v1.0.0



注意事项：

1、天气检测和清洁度功能只能在白天(天完全黑时相机拍不出效果)检测。天气模型当前只可检测晴天、下雨，下雪和沙尘暴暂未覆盖；

2、天气检测请在机器处于静态时检测，需要避开桥架区域，保证组件处于相机前方；

3、清洁度增加了异常图像(图像太模糊、拍到桥架区域、清洗机表面、以及其他非组件间区域)类，当判定为异常图时，不对清洁度进行统计；

4、清洁度当前因无轻度灰尘图像，故只覆盖3类(很脏、干净、异常图)；

5、检测模型1分为4类,分别是下坡、桥架区域、预留类别(防止增加新类别导致重头训练)、异常图(防止一些异常图导致过杀)；

6、下坡检测：清洗机距离下坡位置两个组件远时开始检测是否有下坡，检测到下坡时，清洗机要减速，低速运行到下坡区域检测桥架是否有断裂或者角度太大；

7、下坡检测、桥架断裂和角度计算功能可以全天24小时应用；

8、天将要完全黑那一段时间，相机尚未自动转夜视(红外图)，所采集的图像效果很差，很难准确用于检测识别，可考虑上坡或平桥架进行适当减速；

9、检测1暂未规避模糊图；



下阶段优化目标：

1、优化模型初始化速度，现在5个模型加载需要3分25秒；

2、天气模型：增加异常类判定，如桥架区域、图模糊(运动中图会相对模糊)、其他非组件区域；

3、清洁度模型：收集现场长期不清扫的组件图,定义为类别1(普通脏)；

4、检测模型1：

​     4.1、桥架区域：收集现场组件表面脏时的图片，收集非固定桥架图；

​     4.1.1、控制漏检和过啥率主要受4种条件影响：组件干净程度、背景、桥架类型及其长短和角度、光线（主要考虑天气全黑的情况）。

​    4.1.2需要覆盖多种情形图。

​    4.2、下坡判断：数据收集是4.1的子集；

​    4.3、增加模糊图判断功能，如果是模糊图就不进行检测了；

5、分割：数据收集是4.1的子集；

6、模糊图判断&&去模糊：将很模糊的图直接去掉不尽兴推理，一般模糊的图进行去模糊再送入检测2；

7、增加图像亮度自适应检测功能：根据当前图像亮度判断相机是否需要切换参数。

8、增加图像归一化算法：计算每个亮度像素出现的概率，去掉概率很低的像素，然后将图像归一化到[255*0.1，255*0.9]，这可以有效防止参数、光线异常等情况；

9、针对分割，进行再次切图，去掉桥架两端的干扰区域，切取最中间的一片图，可以有效减少干扰，提升目标像素占比；



注意：从更高的维度审视所有模型所拥有的功能，可以考虑专门做一个模型先判断当前采集到的帧是不是有效图，将相机低头、角度严重偏移、模糊等情况先进行规避；